{"ast":null,"code":"var _jsxFileName = \"/Users/anya_biswas/Desktop/316-HW4-Playlister-Anya/client/src/auth/index.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useEffect, useState } from \"react\";\nimport { useHistory } from 'react-router-dom';\nimport authRequestSender from './requests';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nconsole.log(\"create AuthContext: \" + AuthContext);\n\n// THESE ARE ALL THE TYPES OF UPDATES TO OUR AUTH STATE THAT CAN BE PROCESSED\nexport const AuthActionType = {\n  GET_LOGGED_IN: \"GET_LOGGED_IN\",\n  LOGIN_USER: \"LOGIN_USER\",\n  LOGOUT_USER: \"LOGOUT_USER\",\n  REGISTER_USER: \"REGISTER_USER\"\n};\nfunction AuthContextProvider(props) {\n  _s();\n  const [auth, setAuth] = useState({\n    user: null,\n    loggedIn: false,\n    errorMessage: null\n  });\n  const history = useHistory();\n  useEffect(() => {\n    auth.getLoggedIn();\n  }, []);\n  const authReducer = action => {\n    const {\n      type,\n      payload\n    } = action;\n    switch (type) {\n      case AuthActionType.GET_LOGGED_IN:\n        {\n          return setAuth({\n            user: payload.user,\n            loggedIn: payload.loggedIn,\n            errorMessage: null\n          });\n        }\n      case AuthActionType.LOGIN_USER:\n        {\n          return setAuth({\n            user: payload.user,\n            loggedIn: payload.loggedIn,\n            errorMessage: payload.errorMessage\n          });\n        }\n      case AuthActionType.LOGOUT_USER:\n        {\n          return setAuth({\n            user: null,\n            loggedIn: false,\n            errorMessage: null\n          });\n        }\n      case AuthActionType.REGISTER_USER:\n        {\n          return setAuth({\n            user: payload.user,\n            loggedIn: payload.loggedIn,\n            errorMessage: payload.errorMessage\n          });\n        }\n      default:\n        return auth;\n    }\n  };\n  auth.getLoggedIn = async function () {\n    try {\n      var _response$data;\n      const response = await authRequestSender.getLoggedIn();\n      if ((response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.loggedIn) !== undefined) {\n        authReducer({\n          type: AuthActionType.GET_LOGGED_IN,\n          payload: {\n            loggedIn: response.data.loggedIn,\n            user: response.data.user\n          }\n        });\n      }\n    } catch (error) {\n      console.error(\"Error checking login status:\", error);\n    }\n  };\n  auth.registerUser = async function (firstName, lastName, email, password, passwordVerify) {\n    console.log(\"REGISTERING USER\");\n    try {\n      var _response$data2;\n      const response = await authRequestSender.registerUser(firstName, lastName, email, password, passwordVerify);\n      if (response !== null && response !== void 0 && (_response$data2 = response.data) !== null && _response$data2 !== void 0 && _response$data2.user) {\n        console.log(\"Registered Successfully\");\n        authReducer({\n          type: AuthActionType.REGISTER_USER,\n          payload: {\n            user: response.data.user,\n            loggedIn: true,\n            errorMessage: null\n          }\n        });\n        history.push(\"/login\");\n        console.log(\"NOW WE LOGIN\");\n        await auth.loginUser(email, password);\n        console.log(\"LOGGED IN\");\n      }\n    } catch (error) {\n      const message = (error === null || error === void 0 ? void 0 : error.errorMessage) || (error === null || error === void 0 ? void 0 : error.message) || \"Registration failed.\";\n      authReducer({\n        type: AuthActionType.REGISTER_USER,\n        payload: {\n          user: auth.user,\n          loggedIn: false,\n          errorMessage: message\n        }\n      });\n    }\n  };\n  auth.loginUser = async function (email, password) {\n    try {\n      var _response$data3;\n      const response = await authRequestSender.loginUser(email, password);\n      if (response !== null && response !== void 0 && (_response$data3 = response.data) !== null && _response$data3 !== void 0 && _response$data3.user) {\n        authReducer({\n          type: AuthActionType.LOGIN_USER,\n          payload: {\n            user: response.data.user,\n            loggedIn: true,\n            errorMessage: null\n          }\n        });\n        history.push(\"/\");\n      }\n    } catch (error) {\n      const message = (error === null || error === void 0 ? void 0 : error.errorMessage) || (error === null || error === void 0 ? void 0 : error.message) || \"Login failed.\";\n      authReducer({\n        type: AuthActionType.LOGIN_USER,\n        payload: {\n          user: auth.user,\n          loggedIn: false,\n          errorMessage: message\n        }\n      });\n    }\n  };\n  auth.logoutUser = async function () {\n    const response = await authRequestSender.logoutUser();\n    if (response.status === 200) {\n      authReducer({\n        type: AuthActionType.LOGOUT_USER,\n        payload: null\n      });\n      history.push(\"/\");\n    }\n  };\n  auth.getUserInitials = function () {\n    let initials = \"\";\n    if (auth.user) {\n      initials += auth.user.firstName.charAt(0);\n      initials += auth.user.lastName.charAt(0);\n    }\n    console.log(\"user initials: \" + initials);\n    return initials;\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      auth\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 9\n  }, this);\n}\n_s(AuthContextProvider, \"1LKNz/EyYUPERN86RvMkD7rRQh8=\", false, function () {\n  return [useHistory];\n});\n_c = AuthContextProvider;\nexport default AuthContext;\nexport { AuthContextProvider };\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["React","createContext","useEffect","useState","useHistory","authRequestSender","jsxDEV","_jsxDEV","AuthContext","console","log","AuthActionType","GET_LOGGED_IN","LOGIN_USER","LOGOUT_USER","REGISTER_USER","AuthContextProvider","props","_s","auth","setAuth","user","loggedIn","errorMessage","history","getLoggedIn","authReducer","action","type","payload","_response$data","response","data","undefined","error","registerUser","firstName","lastName","email","password","passwordVerify","_response$data2","push","loginUser","message","_response$data3","logoutUser","status","getUserInitials","initials","charAt","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/anya_biswas/Desktop/316-HW4-Playlister-Anya/client/src/auth/index.js"],"sourcesContent":["import React, { createContext, useEffect, useState } from \"react\";\nimport { useHistory } from 'react-router-dom'\nimport authRequestSender from './requests'\n\nconst AuthContext = createContext();\nconsole.log(\"create AuthContext: \" + AuthContext);\n\n// THESE ARE ALL THE TYPES OF UPDATES TO OUR AUTH STATE THAT CAN BE PROCESSED\nexport const AuthActionType = {\n    GET_LOGGED_IN: \"GET_LOGGED_IN\",\n    LOGIN_USER: \"LOGIN_USER\",\n    LOGOUT_USER: \"LOGOUT_USER\",\n    REGISTER_USER: \"REGISTER_USER\"\n}\n\nfunction AuthContextProvider(props) {\n    const [auth, setAuth] = useState({\n        user: null,\n        loggedIn: false,\n        errorMessage: null\n    });\n    const history = useHistory();\n\n    useEffect(() => {\n        auth.getLoggedIn();\n    }, []);\n\n    const authReducer = (action) => {\n        const { type, payload } = action;\n        switch (type) {\n            case AuthActionType.GET_LOGGED_IN: {\n                return setAuth({\n                    user: payload.user,\n                    loggedIn: payload.loggedIn,\n                    errorMessage: null\n                });\n            }\n            case AuthActionType.LOGIN_USER: {\n                return setAuth({\n                    user: payload.user,\n                    loggedIn: payload.loggedIn,\n                    errorMessage: payload.errorMessage\n                })\n            }\n            case AuthActionType.LOGOUT_USER: {\n                return setAuth({\n                    user: null,\n                    loggedIn: false,\n                    errorMessage: null\n                })\n            }\n            case AuthActionType.REGISTER_USER: {\n                return setAuth({\n                    user: payload.user,\n                    loggedIn: payload.loggedIn,\n                    errorMessage: payload.errorMessage\n                })\n            }\n            default:\n                return auth;\n        }\n    }\n\n    auth.getLoggedIn = async function () {\n        try {\n            const response = await authRequestSender.getLoggedIn();\n            if (response?.data?.loggedIn !== undefined) {  \n                authReducer({\n                    type: AuthActionType.GET_LOGGED_IN,\n                    payload: {\n                        loggedIn: response.data.loggedIn,   \n                        user: response.data.user            \n                    }\n                });\n            }\n        } catch (error) {\n            console.error(\"Error checking login status:\", error);\n        }\n    };\n    \n    auth.registerUser = async function (firstName, lastName, email, password, passwordVerify) {\n        console.log(\"REGISTERING USER\");\n        try {\n            const response = await authRequestSender.registerUser(firstName, lastName, email, password, passwordVerify);\n    \n            if (response?.data?.user) {   \n                console.log(\"Registered Successfully\");\n                authReducer({\n                    type: AuthActionType.REGISTER_USER,\n                    payload: {\n                        user: response.data.user,  \n                        loggedIn: true,\n                        errorMessage: null\n                    }\n                });\n                history.push(\"/login\");\n                console.log(\"NOW WE LOGIN\");\n                await auth.loginUser(email, password);\n                console.log(\"LOGGED IN\");\n            }\n        } catch (error) {\n            const message = error?.errorMessage || error?.message || \"Registration failed.\";\n            authReducer({\n                type: AuthActionType.REGISTER_USER,\n                payload: {\n                    user: auth.user,\n                    loggedIn: false,\n                    errorMessage: message\n                }\n            });\n        }\n    };\n    \n    auth.loginUser = async function (email, password) {\n        try {\n            const response = await authRequestSender.loginUser(email, password);\n    \n            if (response?.data?.user) {   \n                authReducer({\n                    type: AuthActionType.LOGIN_USER,\n                    payload: {\n                        user: response.data.user,   \n                        loggedIn: true,\n                        errorMessage: null\n                    }\n                });\n                history.push(\"/\");\n            }\n        } catch (error) {\n            const message = error?.errorMessage || error?.message || \"Login failed.\";\n            authReducer({\n                type: AuthActionType.LOGIN_USER,\n                payload: {\n                    user: auth.user,\n                    loggedIn: false,\n                    errorMessage: message\n                }\n            });\n        }\n    };\n    \n\n     auth.logoutUser = async function() {\n        const response = await authRequestSender.logoutUser();\n        if (response.status === 200) {\n            authReducer( {\n                type: AuthActionType.LOGOUT_USER,\n                payload: null\n            })\n            history.push(\"/\");\n        }\n    }\n\n    auth.getUserInitials = function() {\n        let initials = \"\";\n        if (auth.user) {\n            initials += auth.user.firstName.charAt(0);\n            initials += auth.user.lastName.charAt(0);\n        }\n        console.log(\"user initials: \" + initials);\n        return initials;\n    }\n\n    return (\n        <AuthContext.Provider value={{\n            auth\n        }}>\n            {props.children}\n        </AuthContext.Provider>\n    );\n}\n\nexport default AuthContext;\nexport { AuthContextProvider };"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACjE,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,OAAOC,iBAAiB,MAAM,YAAY;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAE1C,MAAMC,WAAW,gBAAGP,aAAa,CAAC,CAAC;AACnCQ,OAAO,CAACC,GAAG,CAAC,sBAAsB,GAAGF,WAAW,CAAC;;AAEjD;AACA,OAAO,MAAMG,cAAc,GAAG;EAC1BC,aAAa,EAAE,eAAe;EAC9BC,UAAU,EAAE,YAAY;EACxBC,WAAW,EAAE,aAAa;EAC1BC,aAAa,EAAE;AACnB,CAAC;AAED,SAASC,mBAAmBA,CAACC,KAAK,EAAE;EAAAC,EAAA;EAChC,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGjB,QAAQ,CAAC;IAC7BkB,IAAI,EAAE,IAAI;IACVC,QAAQ,EAAE,KAAK;IACfC,YAAY,EAAE;EAClB,CAAC,CAAC;EACF,MAAMC,OAAO,GAAGpB,UAAU,CAAC,CAAC;EAE5BF,SAAS,CAAC,MAAM;IACZiB,IAAI,CAACM,WAAW,CAAC,CAAC;EACtB,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,WAAW,GAAIC,MAAM,IAAK;IAC5B,MAAM;MAAEC,IAAI;MAAEC;IAAQ,CAAC,GAAGF,MAAM;IAChC,QAAQC,IAAI;MACR,KAAKjB,cAAc,CAACC,aAAa;QAAE;UAC/B,OAAOQ,OAAO,CAAC;YACXC,IAAI,EAAEQ,OAAO,CAACR,IAAI;YAClBC,QAAQ,EAAEO,OAAO,CAACP,QAAQ;YAC1BC,YAAY,EAAE;UAClB,CAAC,CAAC;QACN;MACA,KAAKZ,cAAc,CAACE,UAAU;QAAE;UAC5B,OAAOO,OAAO,CAAC;YACXC,IAAI,EAAEQ,OAAO,CAACR,IAAI;YAClBC,QAAQ,EAAEO,OAAO,CAACP,QAAQ;YAC1BC,YAAY,EAAEM,OAAO,CAACN;UAC1B,CAAC,CAAC;QACN;MACA,KAAKZ,cAAc,CAACG,WAAW;QAAE;UAC7B,OAAOM,OAAO,CAAC;YACXC,IAAI,EAAE,IAAI;YACVC,QAAQ,EAAE,KAAK;YACfC,YAAY,EAAE;UAClB,CAAC,CAAC;QACN;MACA,KAAKZ,cAAc,CAACI,aAAa;QAAE;UAC/B,OAAOK,OAAO,CAAC;YACXC,IAAI,EAAEQ,OAAO,CAACR,IAAI;YAClBC,QAAQ,EAAEO,OAAO,CAACP,QAAQ;YAC1BC,YAAY,EAAEM,OAAO,CAACN;UAC1B,CAAC,CAAC;QACN;MACA;QACI,OAAOJ,IAAI;IACnB;EACJ,CAAC;EAEDA,IAAI,CAACM,WAAW,GAAG,kBAAkB;IACjC,IAAI;MAAA,IAAAK,cAAA;MACA,MAAMC,QAAQ,GAAG,MAAM1B,iBAAiB,CAACoB,WAAW,CAAC,CAAC;MACtD,IAAI,CAAAM,QAAQ,aAARA,QAAQ,wBAAAD,cAAA,GAARC,QAAQ,CAAEC,IAAI,cAAAF,cAAA,uBAAdA,cAAA,CAAgBR,QAAQ,MAAKW,SAAS,EAAE;QACxCP,WAAW,CAAC;UACRE,IAAI,EAAEjB,cAAc,CAACC,aAAa;UAClCiB,OAAO,EAAE;YACLP,QAAQ,EAAES,QAAQ,CAACC,IAAI,CAACV,QAAQ;YAChCD,IAAI,EAAEU,QAAQ,CAACC,IAAI,CAACX;UACxB;QACJ,CAAC,CAAC;MACN;IACJ,CAAC,CAAC,OAAOa,KAAK,EAAE;MACZzB,OAAO,CAACyB,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACxD;EACJ,CAAC;EAEDf,IAAI,CAACgB,YAAY,GAAG,gBAAgBC,SAAS,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,cAAc,EAAE;IACtF/B,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;IAC/B,IAAI;MAAA,IAAA+B,eAAA;MACA,MAAMV,QAAQ,GAAG,MAAM1B,iBAAiB,CAAC8B,YAAY,CAACC,SAAS,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,cAAc,CAAC;MAE3G,IAAIT,QAAQ,aAARA,QAAQ,gBAAAU,eAAA,GAARV,QAAQ,CAAEC,IAAI,cAAAS,eAAA,eAAdA,eAAA,CAAgBpB,IAAI,EAAE;QACtBZ,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC;QACtCgB,WAAW,CAAC;UACRE,IAAI,EAAEjB,cAAc,CAACI,aAAa;UAClCc,OAAO,EAAE;YACLR,IAAI,EAAEU,QAAQ,CAACC,IAAI,CAACX,IAAI;YACxBC,QAAQ,EAAE,IAAI;YACdC,YAAY,EAAE;UAClB;QACJ,CAAC,CAAC;QACFC,OAAO,CAACkB,IAAI,CAAC,QAAQ,CAAC;QACtBjC,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;QAC3B,MAAMS,IAAI,CAACwB,SAAS,CAACL,KAAK,EAAEC,QAAQ,CAAC;QACrC9B,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;MAC5B;IACJ,CAAC,CAAC,OAAOwB,KAAK,EAAE;MACZ,MAAMU,OAAO,GAAG,CAAAV,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEX,YAAY,MAAIW,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEU,OAAO,KAAI,sBAAsB;MAC/ElB,WAAW,CAAC;QACRE,IAAI,EAAEjB,cAAc,CAACI,aAAa;QAClCc,OAAO,EAAE;UACLR,IAAI,EAAEF,IAAI,CAACE,IAAI;UACfC,QAAQ,EAAE,KAAK;UACfC,YAAY,EAAEqB;QAClB;MACJ,CAAC,CAAC;IACN;EACJ,CAAC;EAEDzB,IAAI,CAACwB,SAAS,GAAG,gBAAgBL,KAAK,EAAEC,QAAQ,EAAE;IAC9C,IAAI;MAAA,IAAAM,eAAA;MACA,MAAMd,QAAQ,GAAG,MAAM1B,iBAAiB,CAACsC,SAAS,CAACL,KAAK,EAAEC,QAAQ,CAAC;MAEnE,IAAIR,QAAQ,aAARA,QAAQ,gBAAAc,eAAA,GAARd,QAAQ,CAAEC,IAAI,cAAAa,eAAA,eAAdA,eAAA,CAAgBxB,IAAI,EAAE;QACtBK,WAAW,CAAC;UACRE,IAAI,EAAEjB,cAAc,CAACE,UAAU;UAC/BgB,OAAO,EAAE;YACLR,IAAI,EAAEU,QAAQ,CAACC,IAAI,CAACX,IAAI;YACxBC,QAAQ,EAAE,IAAI;YACdC,YAAY,EAAE;UAClB;QACJ,CAAC,CAAC;QACFC,OAAO,CAACkB,IAAI,CAAC,GAAG,CAAC;MACrB;IACJ,CAAC,CAAC,OAAOR,KAAK,EAAE;MACZ,MAAMU,OAAO,GAAG,CAAAV,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEX,YAAY,MAAIW,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEU,OAAO,KAAI,eAAe;MACxElB,WAAW,CAAC;QACRE,IAAI,EAAEjB,cAAc,CAACE,UAAU;QAC/BgB,OAAO,EAAE;UACLR,IAAI,EAAEF,IAAI,CAACE,IAAI;UACfC,QAAQ,EAAE,KAAK;UACfC,YAAY,EAAEqB;QAClB;MACJ,CAAC,CAAC;IACN;EACJ,CAAC;EAGAzB,IAAI,CAAC2B,UAAU,GAAG,kBAAiB;IAChC,MAAMf,QAAQ,GAAG,MAAM1B,iBAAiB,CAACyC,UAAU,CAAC,CAAC;IACrD,IAAIf,QAAQ,CAACgB,MAAM,KAAK,GAAG,EAAE;MACzBrB,WAAW,CAAE;QACTE,IAAI,EAAEjB,cAAc,CAACG,WAAW;QAChCe,OAAO,EAAE;MACb,CAAC,CAAC;MACFL,OAAO,CAACkB,IAAI,CAAC,GAAG,CAAC;IACrB;EACJ,CAAC;EAEDvB,IAAI,CAAC6B,eAAe,GAAG,YAAW;IAC9B,IAAIC,QAAQ,GAAG,EAAE;IACjB,IAAI9B,IAAI,CAACE,IAAI,EAAE;MACX4B,QAAQ,IAAI9B,IAAI,CAACE,IAAI,CAACe,SAAS,CAACc,MAAM,CAAC,CAAC,CAAC;MACzCD,QAAQ,IAAI9B,IAAI,CAACE,IAAI,CAACgB,QAAQ,CAACa,MAAM,CAAC,CAAC,CAAC;IAC5C;IACAzC,OAAO,CAACC,GAAG,CAAC,iBAAiB,GAAGuC,QAAQ,CAAC;IACzC,OAAOA,QAAQ;EACnB,CAAC;EAED,oBACI1C,OAAA,CAACC,WAAW,CAAC2C,QAAQ;IAACC,KAAK,EAAE;MACzBjC;IACJ,CAAE;IAAAkC,QAAA,EACGpC,KAAK,CAACoC;EAAQ;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACG,CAAC;AAE/B;AAACvC,EAAA,CA3JQF,mBAAmB;EAAA,QAMRZ,UAAU;AAAA;AAAAsD,EAAA,GANrB1C,mBAAmB;AA6J5B,eAAeR,WAAW;AAC1B,SAASQ,mBAAmB;AAAG,IAAA0C,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}